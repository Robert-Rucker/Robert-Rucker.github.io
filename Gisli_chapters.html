<html>
  <head>
    <title>Locations Visited in Gisli Surrson's Saga</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
    <script src="https://skeate.dev/Leaflet.timeline/examples/leaflet.timeline.js"></script>
    <link rel="stylesheet" href="https://Robert-Rucker.github.io/GS_header.css">
    <link rel="stylesheet" href="https://Robert-Rucker.github.io/GS_left.css">
    <link rel="stylesheet" href="https://Robert-Rucker.github.io/GS_footer.css">


</head>
<body>

    <div class="left">
    <div id="info" style= overflow:scroll;overflow-y:auto;>
      <p>Locations and Chapters:</p>
      <ul id="displayed-list"></ul>
    </div>
    </div>
	
	<div class="footer">
	<div class="inner_footer">
		<div class="logo_container">
			<h1>Gisli Sursson's Saga</h1>
		</div>
		
	<ul class="navigation">
		<a href="https://Robert-Rucker.github.io/Gisli_saga.html"><li>Chapter Information</li></a>
		<a href="https://Robert-Rucker.github.io/Gisli_chapters.html"><li>Timeline</li></a>
		<a href="https://Robert-Rucker.github.io/Gisli_search.html" ><li>Search</li></a>
		<a href="https://Robert-Rucker.github.io/Gisli_saga_about.html"><li>About</li></a>
	</ul>
	</div>
	</div>
	
    <div id="map"></div>

    <script>
	 function getColorFor(value) {
    return value >= 1 ? '#a92525':
    value >= 0  ? '#ffffbf':
                  '#b2182b';
            }
			
	var background  = L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.{ext}', {
	attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
	subdomains: 'abcd',
	minZoom: 0,
	maxZoom: 20,
	ext: 'png'
});

      var map = L.map("map", {
        layers: [background],
        center: new L.LatLng(60, -7),
        zoom: 4
      });

      // this is just used to show the polls in the sidebar
      function updateList(timeline) {
        var displayed = timeline.getLayers();
        var list = document.getElementById("displayed-list");
        list.innerHTML = "";
        displayed.forEach(function (elec) {
          var li = document.createElement("li");
          li.innerHTML = elec.feature.properties.NAME + ' -  All of the Chapters: ' + elec.feature.properties.CHAP + '<br/> First Chapter Appeared In: ' + elec.feature.properties.REP;
          list.appendChild(li);
        });
      }

      // this is similar to previous example --
      function onLoadData(data) {
        var getInterval = function (elec) {
          return {
            start: elec.properties.start,
            end: elec.properties.end,
          };
        };
        var timelineControl = L.timelineSliderControl({
          formatOutput: function (date) {
            return new Date(date).toString();
          },
        });
        var timeline = L.timeline(data, {
          getInterval: getInterval,
          pointToLayer: function (data, latlng) {
		    var minValue = 2;
			var minRadius = 4;
            var diff = (data.properties.DIFF);
		  	function calcRadius(val) {
				return 2.0083 * Math.pow(val/minValue,.5716)*minRadius;
			};
            return L.circleMarker(latlng, {
              radius: calcRadius(data.properties.EV),
              color: getColorFor(data.properties.DIFF),
              fillColor: getColorFor(data.properties.DIFF),
            }).bindPopup('<p>' + data.properties.NAME + '<br/>' + 'Times Visited:' + data.properties.EV + '</p>');
          },
        });
        timelineControl.addTo(map);
        timelineControl.addTimelines(timeline);
        timeline.addTo(map);
        timeline.on("change", function (e) {
          updateList(e.target);
        });
        updateList(timeline);
      }
	  

    </script>
    <script src="https://Robert-Rucker.github.io/GS_time.jsonp "></script>
	

  </body>
</html>
